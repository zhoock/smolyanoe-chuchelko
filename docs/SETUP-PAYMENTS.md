# –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–ª–∞—Ç–µ–∂–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã

## üöÄ –ë—ã—Å—Ç—Ä–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ (5 –º–∏–Ω—É—Ç)

### 1. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–ª—é—á–∞ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è

```bash
npm run generate-encryption-key
```

**–°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –≤—ã–≤–æ–¥:** `ENCRYPTION_KEY=xxx...`

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

**–î–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:**
–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` (–Ω–∞ –æ—Å–Ω–æ–≤–µ `.env.example`):

```bash
cp .env.example .env
# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ .env –∏ –¥–æ–±–∞–≤—å—Ç–µ –≤–∞—à–∏ –∑–Ω–∞—á–µ–Ω–∏—è
```

**–î–ª—è Netlify:**

**‚ö†Ô∏è –≠—Ç–æ —Ç—Ä–µ–±—É–µ—Ç —Ä—É—á–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ Netlify**

üìñ **–ü–æ—à–∞–≥–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è:** [NETLIFY-QUICK-START.md](./NETLIFY-QUICK-START.md) (–±—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç)

**–ö—Ä–∞—Ç–∫–æ:**

1. –í –ª–µ–≤–æ–º –º–µ–Ω—é –Ω–∞–∂–º–∏—Ç–µ **"Project configuration"**
2. –í—ã–±–µ—Ä–∏—Ç–µ **"Environment variables"**
3. –ù–∞–∂–º–∏—Ç–µ **"Add a variable"** –∏ –¥–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ (—Å–º. —Å–ø–∏—Å–æ–∫ –Ω–∏–∂–µ)
4. –ü–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö **–ø–µ—Ä–µ–¥–µ–ø–ª–æ–π—Ç–µ –ø—Ä–æ–µ–∫—Ç** (Deploys ‚Üí Trigger deploy)

**–ü–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è:** [NETLIFY-ENV-MANUAL.md](./NETLIFY-ENV-MANUAL.md)

### 3. –°–æ–∑–¥–∞–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

–ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ PostgreSQL –∏ —Å–æ–∑–¥–∞–π—Ç–µ –ë–î:

```sql
CREATE DATABASE payment_db;
```

### 4. –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π

```bash
export DATABASE_URL="postgresql://user:pass@host:port/payment_db"
npm run migrate
```

### 5. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
export DATABASE_URL="postgresql://user:pass@host:port/payment_db"
export ENCRYPTION_KEY="your-key-from-step-1"
npm run test-db
```

## üìã –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–ª—è Netlify

| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è            | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ     | –ü—Ä–∏–º–µ—Ä                                         | –û–ø–∏—Å–∞–Ω–∏–µ                                |
| --------------------- | --------------- | ---------------------------------------------- | --------------------------------------- |
| `DATABASE_URL`        | ‚úÖ –î–∞           | `postgresql://user:pass@host:port/db`          | –°—Ç—Ä–æ–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ PostgreSQL         |
| `ENCRYPTION_KEY`      | ‚úÖ –î–∞           | `Vo9TISlSpeukILKP3HgkJBvUvyFAnFP/u56rdqKzKZ0=` | –ö–ª—é—á —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è (–∏–∑ —à–∞–≥–∞ 1)             |
| `YOOKASSA_SHOP_ID`    | ‚ö†Ô∏è –î–ª—è fallback | `123456`                                       | ID –º–∞–≥–∞–∑–∏–Ω–∞ (–¥–ª—è –∞–∫–∫–∞—É–Ω—Ç–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã)    |
| `YOOKASSA_SECRET_KEY` | ‚ö†Ô∏è –î–ª—è fallback | `test_xxx`                                     | –°–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á (–¥–ª—è –∞–∫–∫–∞—É–Ω—Ç–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã) |
| `YOOKASSA_API_URL`    | ‚ùå –ù–µ—Ç          | `https://api.yookassa.ru/v3/payments`          | URL API (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)                  |

**üìñ –ü–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è:** [NETLIFY-ENV-SETUP.md](./NETLIFY-ENV-SETUP.md)

## ‚úÖ –ß–µ–∫–ª–∏—Å—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

- [ ] –ö–ª—é—á —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω (`npm run generate-encryption-key`)
- [ ] PostgreSQL –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —Å–æ–∑–¥–∞–Ω–∞
- [ ] `DATABASE_URL` –Ω–∞—Å—Ç—Ä–æ–µ–Ω (–ª–æ–∫–∞–ª—å–Ω–æ –∏ –≤ Netlify)
- [ ] `ENCRYPTION_KEY` –Ω–∞—Å—Ç—Ä–æ–µ–Ω (–≤ Netlify)
- [ ] –ú–∏–≥—Ä–∞—Ü–∏–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã (`npm run migrate`)
- [ ] –¢–µ—Å—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è —É—Å–ø–µ—à–µ–Ω (`npm run test-db`)
- [ ] Webhook URL –Ω–∞—Å—Ç—Ä–æ–µ–Ω –≤ –ÆKassa Dashboard
- [ ] –¢–µ—Å—Ç–æ–≤—ã–π –ø–ª–∞—Ç–µ–∂ –ø—Ä–æ—Ö–æ–¥–∏—Ç —É—Å–ø–µ—à–Ω–æ

## üìö –ü–æ–¥—Ä–æ–±–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- [–ß–µ–∫–ª–∏—Å—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏](./setup-checklist.md) - –ø–æ—à–∞–≥–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è
- [–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö](./database-setup.md) - –¥–µ—Ç–∞–ª–∏ —Ä–∞–±–æ—Ç—ã —Å –ë–î
- [–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø–ª–∞—Ç–µ–∂–µ–π](./payment-architecture.md) - –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã
- [–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –ÆKassa](./yookassa-integration.md) - –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –ÆKassa

## üîß –î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

```bash
# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–ª—é—á–∞ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è
npm run generate-encryption-key

# –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π –ë–î
npm run migrate

# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î
npm run test-db
```

## üÜò –ü—Ä–æ–±–ª–µ–º—ã?

–°–º. —Ä–∞–∑–¥–µ–ª **Troubleshooting** –≤ [setup-checklist.md](./setup-checklist.md)
