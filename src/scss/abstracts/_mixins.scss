// src/scss/abstracts/_mixins.scss

// Преобразуем CSS-переменные в SCSS-переменные
$ms-02: 6.876px; // 0.382rem;
$ms-01: 11.125px; // 0.618rem;
$ms-0: 18px; // 1rem;
$ms-1: 29.124px; // 1.618rem;
$ms-2: 47.123px; // 2.618rem;
$ms-3: 76.244px; // 4.236rem;
$ms-4: 123.363px; // 6.854rem;

@use 'sass:math';
@use 'sass:color';

// Button

@mixin button-variant(
  $color: var(--button-color, #dddddd),
  $background: var(--button-background-color, #373633),
  $hover-color: var(--button-color-hover, #ffffff),
  $hover-background: var(--button-background-color-hover, #998238),
  $margin: var(--ms-1) 0,
  $padding: var(--ms-01) var(--ms-0),
  $border-radius: var(--ms-01),
  $disabled-background: var(--button-disabled-background, #9b9b9a)
) {
  margin: $margin;
  padding: $padding;
  color: $color;
  border: 0;
  border-radius: $border-radius;
  transition: all 200ms ease;
  background-color: $background;
  cursor: pointer;
  appearance: none;
  user-select: none;
  text-transform: capitalize;

  &:hover,
  &:active {
    color: $hover-color;
    background-color: $hover-background;

    @media (hover: none) and (pointer: coarse) {
      color: $color;
      background-color: $background;
    }
  }

  &:active {
    scale: 0.98;
  }

  &.disabled,
  &[disabled] {
    &:hover,
    &:focus,
    &:active {
      background-color: $disabled-background;
      cursor: default;
    }
  }
}

$old-phones: 'width < 375px';
$phones: 'width >= 375px';
$tablets: 'width >= 768px';
$desktops: 'width >= 1024px';

@mixin breakpoint($point) {
  /* Для очень маленьких экранов (старые телефоны, узкие экраны) */

  @if $point == old-phones {
    @media ($old-phones) {
      @content;
    }
  }

  // Для современных телефонов

  @if $point == phones {
    @media ($phones) {
      @content;
    }
  }

  // Для планшетов (iPad Mini, Galaxy Tab)

  @if $point == tablet {
    @media ($tablets) {
      @content;
    }
  }

  // Для ноутбуков и десктопов

  @if $point == desktops {
    @media ($desktops) {
      @content;
    }
  }
}

// link

@mixin link-colors($normal, $hover: false, $active: false, $visited: false, $focus: false) {
  color: var(#{$normal});

  @if $hover {
    &:hover {
      color: var(#{$hover});
    }
  }

  @if $active {
    &.active,
    &:active {
      color: var(#{$active});
    }
  }

  @if $visited {
    &:visited {
      color: var(#{$visited});
    }
  }

  @if $focus {
    &:focus {
      color: var(#{$focus});
    }
  }
}

// https://designmodo.com/vertical-rhythm/

// Функция для настройки размера шрифта с учетом базовой линии
// $to-font-size - целевой размер шрифта
// $scale-value - множитель масштаба (по умолчанию 1)
// $base-line-height - базовая высота строки (по умолчанию 18px * 1.618)
// $base-font-size - базовый размер шрифта (по умолчанию 18px)
// пример использования: adjust-font-size-to($ms-0, 0.382, 18px);

@mixin adjust-font-size-to(
  $to-font-size,
  $scale-value: 1,
  $base-line-height: calc(18px * 1.618),
  $base-font-size: 18px
) {
  margin-block: math.div($base-line-height * $scale-value, $to-font-size) + em;
  font-size: math.div($to-font-size, $base-font-size) + rem;
  line-height: math.div($base-line-height * 1.618, $to-font-size);
}

// List

@mixin list($block) {
  display: flex;
  flex-wrap: nowrap;
  gap: var(--ms-0);
  margin: 0 calc(-1 * var(--ms-1)) var(--ms-1);
  padding: 0 var(--ms-1);
  overflow-x: auto;
  scroll-snap-type: x mandatory;

  @extend %hide-scrollbar;

  @include breakpoint(tablet) {
    display: grid;
    gap: $ms-1;
    margin: 0 0 var(--ms-1);
    padding: 0;
    grid-template: minmax(323px, auto) / repeat(auto-fit, minmax(calc(1 / 4 * 1000px), 1fr));

    &:has(:hover) #{$block}__card:not(:hover) {
      opacity: 0.5;
    }
  }

  @include breakpoint(desktops) {
    grid-template-columns: repeat(auto-fill, minmax(calc(1 / 4 * 1000px), 1fr));
  }
}

%hide-scrollbar {
  /* Hide scrollbar for IE, Edge and Firefox */
  -ms-overflow-style: none; /* IE and Edge */
  scrollbar-width: none; /* Firefox */

  /* Hide scrollbar for Chrome, Safari and Opera */
  &::-webkit-scrollbar {
    display: none;
  }
}

%filter {
  background: rgba(var(--extra-background-color), 0.8);
  backdrop-filter: blur(20px);
}

%card {
  flex: none;
  inline-size: 100%;
  transition: all 200ms ease;
  scroll-snap-align: center;
  scroll-snap-stop: always;

  a {
    display: block;
    text-decoration: none;
    color: var(--link-subtitle-color, #dddddd);

    &:focus-visible {
      // позволит визуально выделить элемент за пределами его границ, даже если он обрезан.
      outline-offset: -4px; /* Смещение от границы элемента */
    }

    img {
      margin-block-end: 0;
    }
  }
}

%description {
  margin-block-start: var(--ms-01);
}

// Миксин для светлой темы - убирает дублирование между html.theme-light и @media (prefers-color-scheme: light)
@mixin light-theme-variables {
  --main-background-color: var(--white);
  --extra-background-color: var(--moon-ash);
  --nested-background-color: var(--white);
  --nested-background-text-color: var(--graphite-green);
  --theme-toggler-color: var(--graphite-green);
  --text-color: var(--graphite-green);
  --time-color: var(--quiet-gray);
  --link-color: var(--honeydew-melon);
  --link-color-hover: var(--charcoal);
  --links-header-color: var(--graphite-green);
  --links-header-color-hover: var(--charcoal);
  --links-header-color-active: var(--charcoal);
  --button-lang-menu-color: var(--graphite-green);
  --button-lang-menu-color-hover: var(--charcoal);
  --link-hamburger-color: var(--charcoal);
  --link-hamburger-color-hover: var(--white);
  --link-hamburger-color-active: var(--white);
  --link-subtitle-color: var(--graphite-green);
  --link-button-color: var(--graphite-green);
  --link-button-background-color: var(--icy-mist);
  --link-button-background-color-hover: var(--mango-sorbet);
  --button-color: var(--graphite-green);
  --button-color-hover: var(--graphite-green);
  --button-background-color: var(--icy-mist);
  --button-background-color-hover: var(--mango-sorbet);
  --button-disabled-background: var(--warm-concrete);
  --social-networks-background-color: var(--charcoal);
  --accent-color: var(--mango-sorbet);
  --error-color: var(--pink-terracotta);
  --outline-color: #f3d69f;
  --selection-color: #fbeac4;
  --hr-color: var(--icy-mist);
  --wave-bg: rgb(var(--moon-ash-rgb, 231 231 230) / 70%);
  --wave-progress-fill: rgb(var(--mango-sorbet-rgb, 250 229 155) / 16%);
  --wave-cursor-color: rgb(var(--mango-sorbet-rgb, 250 229 155) / 90%);
  --wave-bars: rgb(var(--charcoal-rgb, 39 39 39) / 42%);
  --wave-bars-active: rgb(var(--mango-sorbet-rgb, 250 229 155) / 78%);
}
