[build]
  publish = "dist"   # <— ВАЖНО: откуда Netlify берёт файлы для прод-раздачи

[dev]
  command = "npm start" # команда для запуска вашего dev-сервера (например, React Dev Server)
  framework = "custom" # кастомная сборка
  targetPort = 8080 # порт, на котором работает ваш webpack dev server
  port = 8888 # порт, на котором Netlify будет проксировать запросы

# API routes должны быть ПЕРЕД общим redirect на index.html
# API routes для сохранения синхронизаций
[[redirects]]
  from = "/api/synced-lyrics*"
  to = "/.netlify/functions/synced-lyrics"
  status = 200
  force = true

# Старый endpoint для обратной совместимости
[[redirects]]
  from = "/api/save-synced-lyrics*"
  to = "/.netlify/functions/synced-lyrics"
  status = 200
  force = true

# API route для сохранения текста трека
[[redirects]]
  from = "/api/save-track-text*"
  to = "/.netlify/functions/save-track-text"
  status = 200
  force = true

# API routes для платежей ЮKassa
[[redirects]]
  from = "/api/create-payment*"
  to = "/.netlify/functions/create-payment"
  status = 200
  force = true

[[redirects]]
  from = "/api/payment-webhook*"
  to = "/.netlify/functions/payment-webhook"
  status = 200
  force = true

[[redirects]]
  from = "/api/payment-settings*"
  to = "/.netlify/functions/payment-settings"
  status = 200
  force = true

# Общий redirect для SPA - должен быть ПОСЛЕДНИМ
[[redirects]]
  from = "/*"
  to = "/index.html"
  status = 200


